(()=>{var e={592:e=>{var t=null,n={getAccountCookie(){return this.getCookie("account")},signoutAccountCookie(){return this.setCookie("account","")},setCookie(e,t,n){var a="";if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toUTCString()}document.cookie=e+"="+(t||"")+a+"; path=/"},getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),a=0;a<n.length;a++){for(var o=n[a];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null}};function a(){return new URL(window.location.href).origin}e.exports={cookieManager:n,getServerURL:a,checkSessionCookie:async function(){if(!n.getAccountCookie())return t=null,!1;try{var e=await fetch(a()+"/account/session",{method:"GET"}),o=await e.json();return o.valid?(t=o,o):(n.signoutAccountCookie("account"),t=null,!1)}catch(e){return n.signoutAccountCookie("account"),t=null,!1}},loginToAccount:async function(e,t){var n={username:e,password:t},o=await fetch(a()+"/account/login",{method:"POST",body:JSON.stringify(n)}),i=await o.json();if(!i.valid)throw new Error(i.message)},signupAccount:async function(e,t){var n={username:e,password:t},o=await fetch(a()+"/account/signup",{method:"POST",body:JSON.stringify(n)}),i=await o.json();if(!i.valid)throw new Error(i.message)},logoutOfAccount:async function(){n.signoutAccountCookie()},getProfilePictureURL:function(e){return a()+"/account/picture/"+e},loginToAdmin:function(){var e=window.prompt("Admin key:");n.setCookie("admin",e)},openLink:function(e,t){var n=document.createElement("a");n.href=e,t&&(n.target="_blank"),n.click()},hasNewMail:async function(){try{var e=await fetch(a()+"/account/mail");if(e.ok){var t=await e.json();if(t.mail)for(var n of t.mail)if(n.new)return!0;return!1}return!1}catch(e){return!1}},getCurrentValidationState:function(){return t},getJoinedRooms:async function(){var e=await fetch(a()+"/account/myrooms");return e.ok?(await e.json()).rooms:[]},removeJoinedRoom:async function(e){await fetch(a()+"/account/removeroom",{method:"POST",body:JSON.stringify({id:e})})}}},149:e=>{var t={styles:{containerClassName:"windowDialogContainer",backgroundClassName:"windowDialogBackground",dialogClassName:"windowDialogBox",buttonClassName:"windowDialogButton",headerClassName:"windowDialogHeader",inputClassName:"windowDialogInput"},texts:{ok:"OK",cancel:"Cancel"},_createDialogBase(){var e=document.createElement("div");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.opacity="0.5",e.className=this.styles.backgroundClassName;var t=document.createElement("div");t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.width="fit-content",t.style.height="fit-content",t.style.padding="20px",t.style.maxWidth="500px",t.style.maxHeight="300px",t.style.minWidth="100px",t.style.minHeight="100px",t.style.overflow="auto",t.className=this.styles.dialogClassName;var n=document.createElement("div");return n.style.zIndex="100",n.className=this.styles.containerClassName,n.append(e),n.append(t),{background:e,dialogBox:t,dialogContainer:n}},_createButtonBase(){var e=document.createElement("div");return e.className=this.styles.buttonClassName,e.style.width="fit-content",e.style.height="fit-content",e.style.minWidth="30px",e.style.minHeight="20px",e.style.padding="3px",e.style.cursor="pointer",e.style.display="inline-block",e},_createHeaderBase(){var e=document.createElement("span");return e.className=this.styles.headerClassName,e},_createColorInputBase(){var e=document.createElement("input");return e.type="color",e},_createBreakBase:()=>document.createElement("br"),_createTextInputBase(){var e=document.createElement("input");return e.type="text",e.className=this.styles.inputClassName,e},_appendHeaders(e,t){var n=e.toString();for(var n of n.split("\n")){var a=this._createHeaderBase();a.textContent=n,t.append(a),t.append(this._createBreakBase())}},displayButtonChooser:function(e,t){var{dialogBox:n,background:a,dialogContainer:o}=this._createDialogBase();return n.focus(),this._appendHeaders(e,n),document.body.append(o),new Promise((e=>{t.forEach(((t,a)=>{var i=this._createButtonBase();i.textContent=t,i.onclick=function(){o.remove(),e(a)},n.append(i)}))}))},alert:function(e){var{dialogBox:t,background:n,dialogContainer:a}=this._createDialogBase();t.focus(),document.body.append(a),this._appendHeaders(e,t);var o=this._createButtonBase();return o.textContent=this.texts.ok,t.append(o),new Promise((e=>{o.onclick=function(){e(),a.remove()}}))},prompt:function(e){var{dialogBox:t,background:n,dialogContainer:a}=this._createDialogBase();t.focus(),document.body.append(a),this._appendHeaders(e,t);var o=this._createTextInputBase();t.append(o),t.append(this._createBreakBase());var i=this._createButtonBase();i.textContent=this.texts.ok,t.append(i);var r=this._createButtonBase();return r.textContent=this.texts.cancel,t.append(r),new Promise((e=>{i.onclick=function(){o.value.length<1?e(void 0):e(o.value),a.remove()},r.onclick=function(){e(),a.remove()}}))},confirm:function(e){var{dialogBox:t,background:n,dialogContainer:a}=this._createDialogBase();t.focus(),document.body.append(a),this._appendHeaders(e,t);var o=this._createButtonBase();o.textContent=this.texts.ok,t.append(o);var i=this._createButtonBase();return i.textContent=this.texts.cancel,t.append(i),new Promise((e=>{o.onclick=function(){e(!0),a.remove()},i.onclick=function(){e(!1),a.remove()}}))},colorPrompt:function(e){var{dialogBox:t,background:n,dialogContainer:a}=this._createDialogBase();t.focus(),document.body.append(a),this._appendHeaders(e,t);var o=this._createColorInputBase();t.append(o),t.append(this._createBreakBase());var i=this._createButtonBase();i.textContent=this.texts.ok,t.append(i);var r=this._createButtonBase();return r.textContent=this.texts.cancel,t.append(r),new Promise((e=>{i.onclick=function(){e(o.value),a.remove()},r.onclick=function(){e(),a.remove()}}))}};e.exports=t},255:e=>{var t={},n={appendElements:function(e,t){for(var n of t)e.append(n)},createElementsFromJSON:function(e){return function e(n){var a=[];for(var o of n)if(o instanceof Element)o&&a.push(o);else if(o){var i=document.createElement(o.element);for(var r of Object.keys(o))if("element"!=r&&"children"!=r){var c=o[r],s=!0;if("gid"==r&&(t[c]=i,s=!1),"style"==r){for(var l of Object.keys(c)){var u=c[l];i.style[l]=u}s=!1}if("innerHTML"==r&&(i.innerHTML=c,s=!1),"textContent"==r&&(i.textContent=c,s=!1),"src"==r&&(i.src=c,s=!1),"srcObject"==r&&(i.srcObject=c,s=!1),"value"==r&&(i.value=c,s=!1),"min"==r&&(i.min=c,s=!1),"max"==r&&(i.max=c,s=!1),"width"==r&&(i.width=c,s=!1),"height"==r&&(i.height=c,s=!1),"className"==r&&(i.className=c,s=!1),"hidden"==r&&(c&&(i.hidden=!0),s=!1),"selected"==r&&(c&&(i.selected=!0),s=!1),"eventListeners"==r){if(Array.isArray(c))for(var d of c)i.addEventListener(d.event,d.func);s=!1}"GPWhenCreated"==r&&(c.bind(i)(i),s=!1),s&&void 0!==i[r]&&(i[r]=c,s=!1),s&&i.setAttribute(r,c)}if(o.children){var m=e(o.children);for(var p of m)i.append(p)}a.push(i)}return a}(e)},getById:function(e){return document.getElementById(e)},setGPId:function(e,n){return t[n]=e,e},getGPId:function(e){return t[e]?t[e]:null},body:document.body,__GP_elements:t};e.exports=n},313:(e,t,n)=>{var a=n(255);a.appendElements(a.body,a.createElementsFromJSON([{element:"div",className:"menuBar",gid:"menu_bar",children:[{element:"img",src:"images/appicon.svg"},{element:"div",className:"menuBarItem",textContent:"Random Rants +",gid:"menu_homeButton"},{element:"div",style:{width:"15px"}},{element:"div",className:"menuBarItem",textContent:"Chat",gid:"menu_chatButton"}]},{element:"div",style:{width:"100%",height:"40px"}}])),n(49),a.getGPId("menu_homeButton").addEventListener("click",(()=>{window.location.href="/"})),a.getGPId("menu_chatButton").addEventListener("click",(()=>{window.location.href="/chat"}))},49:(e,t,n)=>{var a=n(255),o=n(592);a.appendElements(a.getGPId("menu_bar"),a.createElementsFromJSON([{element:"div",className:"userMenuBar",gid:"userMenuBar",children:[]}]));var i={element:"div",className:"menuBarItem",textContent:"Sign in",gid:"menu_signIn"},r={element:"div",className:"menuBarItem",textContent:"Sign up",gid:"menu_signUp"},c={element:"div",className:"menuBarItem",gid:"menu_myAccount"};!async function(){var e=await o.checkSessionCookie();e?(c={element:"div",gid:"menu_myAccount",className:"menuBarItemUsername",style:{display:"flex"},children:[{element:"img",style:{height:"40px",maxWidth:"40px"},src:o.getProfilePictureURL(e.username)},{element:"span",style:{alignContent:"center",fontWeight:"bold",color:e.color||"#000000"},textContent:e.username},{element:"div",style:{width:"10px"}}]},a.appendElements(a.getGPId("menu_bar"),a.createElementsFromJSON([c])),a.getGPId("menu_myAccount").addEventListener("click",(()=>{window.location.href="/myaccount"}))):(a.appendElements(a.getGPId("menu_bar"),a.createElementsFromJSON([i,r])),a.getGPId("menu_signIn").addEventListener("click",(()=>{window.location.href="/signin"})),a.getGPId("menu_signUp").addEventListener("click",(()=>{window.location.href="/signup"})))}()}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n(313);var a=n(255),o=n(592),i=n(149);!async function(){try{var e=await o.checkSessionCookie();if(e){var t=e.color||"#000000",n=[{element:"div",className:"centeredDialog",children:[{element:"div",style:{display:"flex"},children:[{element:"img",style:{height:"50px",maxWidth:"50px"},gid:"profilePicture_account"},{element:"span",style:{alignContent:"center",fontSize:"30px",fontWeight:"bold",color:t},gid:"usernameSpan",textContent:e.username},{element:"div",style:{width:"10px"}},{element:"div",style:{alignContent:"center"},title:"Click this to change your usernames color, appears in chat as well!",children:[{element:"input",type:"color",value:t,gid:"username_color_input"}]}]},{element:"hr"},{element:"span",className:"headerText",textContent:"Your Random Rants + account"},{element:"br"},{element:"div",className:"button",gid:"uploadPFP",textContent:"Upload profile picture"},{element:"div",className:"button",eventListeners:[{event:"click",func:function(){a.getGPId("username_color_input").click()}}],textContent:"Change username color"},{element:"div",className:"button",gid:"signOutButton",textContent:"Sign out"}]}],r=a.createElementsFromJSON(n);a.appendElements(a.body,r);var c=a.getGPId("profilePicture_account"),s=a.getGPId("username_color_input"),l=a.getGPId("usernameSpan");async function u(){var t=o.getProfilePictureURL(e.username);try{await fetch(t,{cache:"reload",mode:"no-cors"})}catch(e){}c.src=o.getProfilePictureURL(e.username)}u(),a.getGPId("signOutButton").onclick=function(){o.logoutOfAccount(),window.location.href="/"},a.getGPId("uploadPFP").onclick=function(){var e=document.createElement("input");e.accept=".png, .jpeg, .bmp, .jpg, .ico, .webm",e.type="file",e.onchange=function(){var t=e.files[0];if(t){var n=new FileReader;n.onload=async function(){try{await fetch(o.getServerURL()+"/account/picture/",{method:"POST",body:n.result.split(",").pop()}),u()}catch(e){i.alert(`Error uploading profile picture, your profile is not uploaded. ${e}`)}},n.readAsDataURL(t)}},e.click()},s.onchange=async function(){t=s.value,l.style.color=t,await fetch(o.getServerURL()+"/account/setcolor/",{method:"POST",body:JSON.stringify({color:s.value})})}}else n=[{element:"div",className:"centeredDialog",children:[{element:"span",className:"headerText",textContent:"Error with your account"},{element:"span",textContent:"You are not logged in, or you where logged out of your account. If you get this error, someone might have changed your user information. This can also happen if you change your user info on another device."}]}],r=a.createElementsFromJSON(n),a.appendElements(a.body,r)}catch(d){i.alert(d)}}()})();